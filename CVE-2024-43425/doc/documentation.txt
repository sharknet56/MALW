# Information about moodleCodeExecutor.py

The file `moodleCodeExecutor.py` is a script designed to exploit the CVE-2024-43425 vulnerability in Moodle. This vulnerability allows authenticated remote code execution by manipulating calculated questions in quizzes.

## Key Features
- **Exploited Vulnerability**: CVE-2024-43425.
- **Affected Moodle Versions**: 4.4 to 4.4.1, 4.3 to 4.3.5, 4.2 to 4.2.8, 4.1 to 4.1.11.
- **Language**: Python.
- **Dependencies**: `requests`, `beautifulsoup4`, `lz4`.

## What it does
1. Extracts session cookies from Firefox.
2. Gets quiz needed info (to be able to execute arbitrary commands).
3. Executing arbitrary commands on the target server.

## How to use:

Usage:

python moodleCodeExecutor --url <url> --courseid <courseid> --cmid <cmid> --cmd <cmd>


Usage example:

python moodleCodeExecutor --url http://127.0.1.1 --courseid 3 --cmid 3 --cmd "whoami"

 parser.add_argument("--url", required=True, help="Target Moodle base URL")
    #parser.add_argument("--username", required=True, help="Moodle username")
    #parser.add_argument("--password", required=True, help="Moodle password")
    parser.add_argument("--courseid", required=True, help="Course ID")
    parser.add_argument("--cmid", required=True, help="Course Module ID (Quiz)")
    parser.add_argument("--cmd", required=True, help="Command t


## Warning
This script should only be used for educational purposes and in controlled environments with explicit permission. Exploiting vulnerabilities without authorization is illegal and can have severe consequences.
